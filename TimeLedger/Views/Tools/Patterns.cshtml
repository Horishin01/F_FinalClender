@using System.Text.Json
@using System.Collections.Generic
@{
    ViewData["Title"] = "生活テンプレ管理";
    ViewData["BodyClass"] = "patterns-page";

    var patternSeed = new
    {
        weekdays = new[]
        {
            new { key = "Mon", label = "月曜" },
            new { key = "Tue", label = "火曜" },
            new { key = "Wed", label = "水曜" },
            new { key = "Thu", label = "木曜" },
            new { key = "Fri", label = "金曜" },
            new { key = "Sat", label = "土曜" },
            new { key = "Sun", label = "日曜" }
        },
        defaultPatterns = new Dictionary<string, object[]>
        {
            ["Mon"] = new object[]
            {
                new { id = "mon-morning", title = "朝学習", start = "06:30", end = "07:30", category = "学習", color = "#4f46e5", notes = "英語リーディング" },
                new { id = "mon-work", title = "勤務・集中", start = "09:00", end = "18:00", category = "仕事", color = "#6366f1", notes = "深い集中タスク" },
                new { id = "mon-evening", title = "夕方の整え", start = "19:00", end = "21:00", category = "生活", color = "#10b981", notes = "買い出し・家事" }
            },
            ["Tue"] = new object[]
            {
                new { id = "tue-learning", title = "通勤インプット", start = "07:30", end = "08:30", category = "学習", color = "#4f46e5", notes = "ポッドキャスト" },
                new { id = "tue-work", title = "勤務", start = "09:00", end = "18:00", category = "仕事", color = "#6366f1", notes = "会議多め" }
            },
            ["Wed"] = new object[]
            {
                new { id = "wed-morning", title = "朝ラン", start = "06:45", end = "07:30", category = "健康", color = "#0ea5e9", notes = "軽いジョグ" },
                new { id = "wed-work", title = "勤務", start = "09:00", end = "18:00", category = "仕事", color = "#6366f1", notes = "レビュー中心" },
                new { id = "wed-night", title = "趣味", start = "20:00", end = "22:00", category = "趣味", color = "#ec4899", notes = "ギター練習" }
            },
            ["Thu"] = new object[]
            {
                new { id = "thu-study", title = "朝学習", start = "06:30", end = "07:15", category = "学習", color = "#4f46e5", notes = "英単語・発音" },
                new { id = "thu-work", title = "勤務", start = "09:00", end = "18:00", category = "仕事", color = "#6366f1", notes = "資料作成" }
            },
            ["Fri"] = new object[]
            {
                new { id = "fri-work", title = "勤務", start = "09:00", end = "17:00", category = "仕事", color = "#6366f1", notes = "タスク締め" },
                new { id = "fri-fun", title = "リフレッシュ", start = "19:00", end = "22:00", category = "趣味", color = "#ec4899", notes = "友人と食事" }
            },
            ["Sat"] = new object[]
            {
                new { id = "sat-home", title = "家事・買い出し", start = "10:00", end = "12:00", category = "生活", color = "#10b981", notes = "週のリセット" },
                new { id = "sat-study", title = "学習ブロック", start = "14:00", end = "16:00", category = "学習", color = "#4f46e5", notes = "資格勉強" }
            },
            ["Sun"] = new object[]
            {
                new { id = "sun-rest", title = "休息", start = "09:00", end = "11:00", category = "健康", color = "#0ea5e9", notes = "睡眠優先" },
                new { id = "sun-plan", title = "週次プラン", start = "16:00", end = "17:00", category = "計画", color = "#f59e0b", notes = "来週のTODO整理" }
            }
        }
    };
}

<div class="ic-root pattern-root">
    <header class="pattern-header">
        <p class="pattern-eyebrow">Life Templates</p>
        <h1 class="pattern-title">生活テンプレ管理</h1>
        <p class="pattern-sub">曜日ごとのブロックを登録・編集し、localStorage に保存します。後で /Events 側から読み取れるようデータは `{ weekday: [blocks...] }` 形式で保持しています。</p>
    </header>

    <div class="pattern-layout">
        <aside class="ic-card pattern-pane pattern-days">
            <div class="ic-card-head">
                <span class="ic-card-title">曜日とタイムライン</span>
            </div>
            <div class="ic-card-body">
                <div class="pattern-day-switcher" id="patternDayList" aria-label="曜日の選択"></div>
                <div class="pattern-blocks" id="patternBlocks" aria-live="polite"></div>
                <div class="pattern-pane-actions">
                    <button type="button" class="ic-btn primary ghost" id="patternNewBlock">＋ ブロック追加</button>
                </div>
            </div>
        </aside>

        <section class="ic-card pattern-pane pattern-editor">
            <div class="ic-card-head">
                <span class="ic-card-title">ブロック編集フォーム</span>
            </div>
            <div class="ic-card-body">
                <form id="patternForm">
                    <input type="hidden" id="patternId" />
                    <div class="pattern-field">
                        <label for="patternTitle" class="form-label">タイトル</label>
                        <input id="patternTitle" class="form-control" type="text" placeholder="例: 朝学習" required />
                    </div>
                    <div class="pattern-field pattern-field-grid">
                        <div>
                            <label for="patternCategory" class="form-label">カテゴリ</label>
                            <input id="patternCategory" class="form-control" type="text" placeholder="学習 / 仕事 / 生活 など" />
                        </div>
                        <div>
                            <label for="patternColor" class="form-label">カラー</label>
                            <input id="patternColor" class="form-control form-control-color" type="color" value="#4f46e5" />
                        </div>
                    </div>
                    <div class="pattern-field pattern-field-grid">
                        <div>
                            <label for="patternStart" class="form-label">開始</label>
                            <input id="patternStart" class="form-control" type="time" required />
                        </div>
                        <div>
                            <label for="patternEnd" class="form-label">終了</label>
                            <input id="patternEnd" class="form-control" type="time" required />
                        </div>
                    </div>
                    <div class="pattern-field">
                        <label for="patternNotes" class="form-label">備考</label>
                        <textarea id="patternNotes" class="form-control" rows="3" placeholder="設備や持ち物、メモなど"></textarea>
                    </div>

                    <div class="pattern-actions">
                        <button type="submit" class="ic-btn primary">保存</button>
                        <button type="button" class="ic-btn ghost" id="patternReset">クリア</button>
                        <button type="button" class="ic-btn pattern-danger" id="patternDelete">削除</button>
                    </div>
                </form>
                <p class="pattern-note">localStorage に保存されたデータはこのブラウザ限定です。API / DB と接続する際は `patterns.js` の `persist()` を差し替えてください。</p>
            </div>
        </section>
    </div>
</div>

<script type="application/json" id="pattern-seed">
@Html.Raw(JsonSerializer.Serialize(patternSeed))
</script>

@section Styles {
    <link rel="stylesheet" href="~/css/events-integrated.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/patterns.css" asp-append-version="true" />
}

@section Scripts {
    <script src="~/js/patterns.js" asp-append-version="true"></script>
}
