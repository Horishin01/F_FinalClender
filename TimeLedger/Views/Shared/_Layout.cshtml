@* Views/Shared/_Layout.cshtml
   目的: 全ページ共通のレイアウト（ヘッダー/ナビ/フッター/スクリプト差し込み）を提供。
   主な構成: ナビ（ロール別リンク制御あり）、モバイルメニュー、RenderBody/RenderSection。
   依存: Bootstrap, FontAwesome, site.css, 個別セクションの Styles/Scripts。 *@
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="theme-color" content="#0d6efd" />
    <title>@ViewData["Title"] - TimeLedger</title>

    <link rel="manifest" href="~/manifest.webmanifest" asp-append-version="true" />
    <link rel="apple-touch-icon" href="~/icons/icon-192.png" />
    <link rel="icon" sizes="192x192" href="~/icons/icon-192.png" />
    <link rel="icon" sizes="512x512" href="~/icons/icon-512.png" />
    <link rel="stylesheet" href="~/lib/fontawesome/css/all.min.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/ui-framework.css" />

    @RenderSection("Styles", required: false)
</head>
@{
    var bodyClass = (ViewData["BodyClass"] as string)?.Trim();
    var bodyClasses = string.IsNullOrWhiteSpace(bodyClass) ? "app-body" : $"app-body {bodyClass}";
}
<body class="@bodyClasses">
    <header class="app-header">
        <div class="container-xl">
            <nav class="app-nav" aria-label="グローバルナビゲーション">
                <div class="brand">
                    <a asp-area="" asp-controller="Home" asp-action="Index">TimeLedger</a>
                    <span class="brand-pill">Calendar</span>
                </div>
                <button class="nav-toggle" type="button" aria-expanded="false" aria-controls="mobileMenu">
                    <i class="fa-solid fa-bars"></i>
                    <span class="nav-toggle-text">メニュー</span>
                </button>
                <div class="app-nav-block" id="primaryNav">
                    <ul class="app-menu">
                        <li><a asp-area="" asp-controller="Home" asp-action="Index">Home</a></li>
                        <li><a asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a></li>
                        <li><a asp-area="" asp-controller="Events" asp-action="Index">カレンダー</a></li>
                        @if (User.Identity?.IsAuthenticated == true && User.IsInRole(RoleNames.Admin))
                        {
                            <li><a asp-area="" asp-controller="Admin" asp-action="Index">管理者ポータル</a></li>
                        }
                    </ul>
                    <div class="app-login">
                        <partial name="_LoginPartial" />
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <div class="app-hero" aria-hidden="true"></div>

    <div class="app-main container-xl">
        <main role="main" class="app-content">
            @if (TempData["StatusMessage"] is string status && !string.IsNullOrWhiteSpace(status))
            {
                <div class="alert alert-warning" role="alert" style="margin-bottom:16px;">
                    <strong>連携メッセージ:</strong> @status
                </div>
            }
            @RenderBody()
        </main>
    </div>

    <footer class="app-footer text-muted">
        <div class="container-xl footer-inner">
            <div>&copy; @DateTime.Now.Year - TimeLedger</div>
            <a asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a>
        </div>
    </footer>

    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/js/app-viewport.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>

    @RenderSection("Scripts", required: false)

    <div id="mobileMenu" class="mobile-menu" aria-hidden="true" tabindex="-1">
        <div class="mobile-menu-head">
            <span class="mobile-brand">TimeLedger</span>
            <button type="button" class="nav-close" aria-label="メニューを閉じる">
                <i class="fa-solid fa-xmark"></i>
            </button>
        </div>
        <ul class="mobile-menu-list">
            <li><a asp-area="" asp-controller="Home" asp-action="Index">Home</a></li>
            <li><a asp-area="" asp-controller="Home" asp-action="Privacy">Privacy</a></li>
            <li><a asp-area="" asp-controller="Events" asp-action="Index">カレンダー</a></li>
            @if (User.Identity?.IsAuthenticated == true && User.IsInRole(RoleNames.Admin))
            {
                <li><a asp-area="" asp-controller="Admin" asp-action="Index">管理者ポータル</a></li>
            }
        </ul>
        <div class="mobile-login">
            <partial name="_LoginPartial" />
        </div>
    </div>
</body>
</html>
